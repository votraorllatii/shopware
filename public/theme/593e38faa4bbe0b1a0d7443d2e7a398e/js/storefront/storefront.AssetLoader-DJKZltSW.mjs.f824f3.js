"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[48883],{8883:(e,t,r)=>{r.d(t,{A:()=>ev,D:()=>eT,a:()=>eg});var n=r(9451),s=r(4808),i=r(8684),o=r(811),a=r(5349),l=r(2108),u=Object.defineProperty,c=(e,t,r)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t,r)=>c(e,"symbol"!=typeof t?t+"":t,r);class f{constructor(e){h(this,"_promise"),h(this,"_resolve"),h(this,"_arrayBuffer",null),h(this,"_size",0),h(this,"_createdAt"),h(this,"_updatedAt"),this._uri=e,this._promise=new Promise(e=>{this._resolve=e}),this._createdAt=new Date,this._updatedAt=new Date}get promise(){return this._promise}get size(){return this._size}get createdAt(){return this._createdAt}get updatedAt(){return this._updatedAt}get arrayBuffer(){return this._arrayBuffer}async load(){let e=await fetch(this._uri);if(!e.ok)throw new l.N(this._uri);try{this._arrayBuffer=await e.arrayBuffer(),this._size+=this._arrayBuffer.byteLength,this._updatedAt=new Date}catch{throw new l.F(this._uri)}return this._resolve(this._arrayBuffer),this._arrayBuffer}}let d=Symbol.for("@shopware-ag/dive/assetcache"),p=globalThis;p[d]||(p[d]=new class{constructor(){h(this,"_cache",new Map)}get(){return this._cache}create(e){let t=new f(e);return this._cache.set(e,t),t}write(e,t){this._cache.set(e,t)}read(e){return this._cache.get(e)??null}delete(...e){e.forEach(e=>{this._cache.delete(e)})}clear(){this._cache.clear()}});let m=p[d];var g=Object.defineProperty,A=(e,t,r)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,T=(e,t,r)=>A(e,"symbol"!=typeof t?t+"":t,r);function v(e,t){if(t===n.RJ4)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==n.rYR&&t!==n.O49)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let s=r.count-2,i=[];if(t===n.rYR)for(let e=1;e<=s;e++)i.push(r.getX(0)),i.push(r.getX(e)),i.push(r.getX(e+1));else for(let e=0;e<s;e++)e%2==0?(i.push(r.getX(e)),i.push(r.getX(e+1)),i.push(r.getX(e+2))):(i.push(r.getX(e+2)),i.push(r.getX(e+1)),i.push(r.getX(e)));i.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let o=e.clone();return o.setIndex(i),o.clearGroups(),o}}class x extends n.aHM{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new S(e)}),this.register(function(e){return new k(e)}),this.register(function(e){return new D(e)}),this.register(function(e){return new H(e)}),this.register(function(e){return new L(e)}),this.register(function(e){return new M(e)}),this.register(function(e){return new I(e)}),this.register(function(e){return new C(e)}),this.register(function(e){return new b(e)}),this.register(function(e){return new O(e)}),this.register(function(e){return new E(e)}),this.register(function(e){return new N(e)}),this.register(function(e){return new P(e)}),this.register(function(e){return new y(e)}),this.register(function(e){return new U(e)}),this.register(function(e){return new F(e)})}load(e,t,r,s){let i;let o=this;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){let t=n.r6x.extractUrlBase(e);i=n.r6x.resolveURL(t,this.path)}else i=n.r6x.extractUrlBase(e);this.manager.itemStart(e);let a=function(t){s?s(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},l=new n.Y9S(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(r){try{o.parse(r,i,function(r){t(r),o.manager.itemEnd(e)},a)}catch(e){a(e)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let s;let i={},o={},a=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer){if(a.decode(new Uint8Array(e,0,4))===B){try{i[_.KHR_BINARY_GLTF]=new j(e)}catch(e){n&&n(e);return}s=JSON.parse(i[_.KHR_BINARY_GLTF].content)}else s=JSON.parse(a.decode(e))}else s=e;if(void 0===s.asset||s.asset.version[0]<2){n&&n(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let l=new eu(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](l);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[t.name]=t,i[t.name]=!0}if(s.extensionsUsed)for(let e=0;e<s.extensionsUsed.length;++e){let t=s.extensionsUsed[e],r=s.extensionsRequired||[];switch(t){case _.KHR_MATERIALS_UNLIT:i[t]=new R;break;case _.KHR_DRACO_MESH_COMPRESSION:i[t]=new K(s,this.dracoLoader);break;case _.KHR_TEXTURE_TRANSFORM:i[t]=new V;break;case _.KHR_MESH_QUANTIZATION:i[t]=new X;break;default:r.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(i),l.setPlugins(o),l.parse(r,n)}parseAsync(e,t){let r=this;return new Promise(function(n,s){r.parse(e,t,n,s)})}}function w(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let _={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class y{constructor(e){this.parser=e,this.name=_.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,n=t.length;r<n;r++){let n=t[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){let t;let r=this.parser,s="light:"+e,i=r.cache.get(s);if(i)return i;let o=r.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],l=new n.Q1f(0xffffff);void 0!==a.color&&l.setRGB(a.color[0],a.color[1],a.color[2],n.Zr2);let u=void 0!==a.range?a.range:0;switch(a.type){case"directional":(t=new n.ZyN(l)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new n.HiM(l)).distance=u;break;case"spot":(t=new n.nCl(l)).distance=u,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,t.angle=a.spot.outerConeAngle,t.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return t.position.set(0,0,0),t.decay=2,ei(t,a),void 0!==a.intensity&&(t.intensity=a.intensity),t.name=r.createUniqueName(a.name||"light_"+e),i=Promise.resolve(t),r.cache.add(s,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,r=this.parser,n=r.json.nodes[e],s=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then(function(e){return r._getNodeRef(t.cache,s,e)})}}class R{constructor(){this.name=_.KHR_MATERIALS_UNLIT}getMaterialType(){return n.V9B}extendParams(e,t,r){let s=[];e.color=new n.Q1f(1,1,1),e.opacity=1;let i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){let t=i.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],n.Zr2),e.opacity=t[3]}void 0!==i.baseColorTexture&&s.push(r.assignTexture(e,"map",i.baseColorTexture,n.er$))}return Promise.all(s)}}class b{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name].emissiveStrength;return void 0!==n&&(t.emissiveIntensity=n),Promise.resolve()}}class S{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let i=[],o=s.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&i.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&i.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(i.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){let e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new n.I9Y(e,e)}return Promise.all(i)}}class E{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],i=n.extensions[this.name];return void 0!==i.iridescenceFactor&&(t.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&s.push(r.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(t.iridescenceIOR=i.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&s.push(r.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(s)}}class L{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_SHEEN}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let i=[];t.sheenColor=new n.Q1f(0,0,0),t.sheenRoughness=0,t.sheen=1;let o=s.extensions[this.name];if(void 0!==o.sheenColorFactor){let e=o.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],n.Zr2)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&i.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,n.er$)),void 0!==o.sheenRoughnessTexture&&i.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(i)}}class M{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],i=n.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&s.push(r.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(s)}}class I{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_VOLUME}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let i=[],o=s.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&i.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;let a=o.attenuationColor||[1,1,1];return t.attenuationColor=new n.Q1f().setRGB(a[0],a[1],a[2],n.Zr2),Promise.all(i)}}class C{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_IOR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}class O{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_SPECULAR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let i=[],o=s.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&i.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));let a=o.specularColorFactor||[1,1,1];return t.specularColor=new n.Q1f().setRGB(a[0],a[1],a[2],n.Zr2),void 0!==o.specularColorTexture&&i.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,n.er$)),Promise.all(i)}}class P{constructor(e){this.parser=e,this.name=_.EXT_MATERIALS_BUMP}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],i=n.extensions[this.name];return t.bumpScale=void 0!==i.bumpFactor?i.bumpFactor:1,void 0!==i.bumpTexture&&s.push(r.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(s)}}class N{constructor(e){this.parser=e,this.name=_.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],i=n.extensions[this.name];return void 0!==i.anisotropyStrength&&(t.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(t.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&s.push(r.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(s)}}class k{constructor(e){this.parser=e,this.name=_.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;let s=n.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,i)}}class D{constructor(e){this.parser=e,this.name=_.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;let i=s.extensions[t],o=n.images[i.source],a=r.textureLoader;if(o.uri){let e=r.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then(function(s){if(s)return r.loadTextureImage(e,i.source,a);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class H{constructor(e){this.parser=e,this.name=_.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;let i=s.extensions[t],o=n.images[i.source],a=r.textureLoader;if(o.uri){let e=r.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then(function(s){if(s)return r.loadTextureImage(e,i.source,a);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class U{constructor(e){this.name=_.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then(function(t){let r=e.byteOffset||0,n=e.byteLength||0,i=e.count,o=e.byteStride,a=new Uint8Array(t,r,n);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(i,o,a,e.mode,e.filter).then(function(e){return e.buffer}):s.ready.then(function(){let t=new ArrayBuffer(i*o);return s.decodeGltfBuffer(new Uint8Array(t),i,o,a,e.mode,e.filter),t})})}}}class F{constructor(e){this.name=_.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;for(let e of t.meshes[r.mesh].primitives)if(e.mode!==Y.TRIANGLES&&e.mode!==Y.TRIANGLE_STRIP&&e.mode!==Y.TRIANGLE_FAN&&void 0!==e.mode)return null;let s=r.extensions[this.name].attributes,i=[],o={};for(let e in s)i.push(this.parser.getDependency("accessor",s[e]).then(t=>(o[e]=t,o[e])));return i.length<1?null:(i.push(this.parser.createNodeMesh(e)),Promise.all(i).then(e=>{let t=e.pop(),r=t.isGroup?t.children:[t],s=e[0].count,i=[];for(let e of r){let t=new n.kn4,r=new n.Pq0,a=new n.PTz,l=new n.Pq0(1,1,1),u=new n.ZLX(e.geometry,e.material,s);for(let e=0;e<s;e++)o.TRANSLATION&&r.fromBufferAttribute(o.TRANSLATION,e),o.ROTATION&&a.fromBufferAttribute(o.ROTATION,e),o.SCALE&&l.fromBufferAttribute(o.SCALE,e),u.setMatrixAt(e,t.compose(r,a,l));for(let t in o)if("_COLOR_0"===t){let e=o[t];u.instanceColor=new n.uWO(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,o[t]);n.B69.prototype.copy.call(u,e),this.parser.assignFinalMaterial(u),i.push(u)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]}))}}let B="glTF",G={JSON:0x4e4f534a,BIN:5130562};class j{constructor(e){this.name=_.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==B)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let n=this.header.length-12,s=new DataView(e,12),i=0;for(;i<n;){let t=s.getUint32(i,!0);i+=4;let n=s.getUint32(i,!0);if(i+=4,n===G.JSON){let n=new Uint8Array(e,12+i,t);this.content=r.decode(n)}else if(n===G.BIN){let r=12+i;this.body=e.slice(r,r+t)}i+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class K{constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=_.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let r=this.json,s=this.dracoLoader,i=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},u={};for(let e in o)a[ee[e]||e.toLowerCase()]=o[e];for(let t in e.attributes){let n=ee[t]||t.toLowerCase();if(void 0!==o[t]){let s=r.accessors[e.attributes[t]],i=J[s.componentType];u[n]=i.name,l[n]=!0===s.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t,r){s.decodeDracoFile(e,function(e){for(let t in e.attributes){let r=e.attributes[t],n=l[t];void 0!==n&&(r.normalized=n)}t(e)},a,u,n.Zr2,r)})})}}class V{constructor(){this.name=_.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class X{constructor(){this.name=_.KHR_MESH_QUANTIZATION}}class W extends n.lGw{constructor(e,t,r,n){super(e,t,r,n)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,s=e*n*3+n;for(let e=0;e!==n;e++)t[e]=r[s+e];return t}interpolate_(e,t,r,n){let s=this.resultBuffer,i=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,u=n-t,c=(r-t)/u,h=c*c,f=h*c,d=e*l,p=d-l,m=-2*f+3*h,g=f-h,A=1-m,T=g-h+c;for(let e=0;e!==o;e++){let t=i[p+e+o],r=i[p+e+a]*u,n=i[d+e+o],l=i[d+e]*u;s[e]=A*t+T*r+m*n+g*l}return s}}let z=new n.PTz;class q extends W{interpolate_(e,t,r,n){let s=super.interpolate_(e,t,r,n);return z.fromArray(s).normalize().toArray(s),s}}let Y={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},J={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},$={9728:n.hxR,9729:n.k6q,9984:n.pHI,9985:n.kRr,9986:n.Cfg,9987:n.$_I},Z={33071:n.ghU,33648:n.kTW,10497:n.GJx},Q={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ee={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},et={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},er={CUBICSPLINE:void 0,LINEAR:n.PJ3,STEP:n.ljd},en={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function es(e,t,r){for(let n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function ei(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function eo(e){let t="",r=Object.keys(e).sort();for(let n=0,s=r.length;n<s;n++)t+=r[n]+":"+e[r[n]]+";";return t}function ea(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let el=new n.kn4;class eu{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new w,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,s=!1,i=-1;"u">typeof navigator&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=(s=navigator.userAgent.indexOf("Firefox")>-1)?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||s&&i<98?this.textureLoader=new n.Tap(this.options.manager):this.textureLoader=new n.Kzg(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new n.Y9S(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,n=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){let i={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};return es(s,i,n),ei(i,n),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(i)})).then(function(){for(let e of i.scenes)e.updateMatrixWorld();e(i)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,n=t.length;r<n;r++){let n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let t=0,n=e.length;t<n;t++){let n=e[t];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(r[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let n=r.clone(),s=(e,t)=>{let r=this.associations.get(e);for(let[n,i]of(null!=r&&this.associations.set(t,r),e.children.entries()))s(i,t.children[n])};return s(r,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let n=e(t[r]);if(n)return n}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let n=0;n<t.length;n++){let s=e(t[n]);s&&r.push(s)}return r}getDependency(e,t){let r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":n=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(!(n=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[_.KHR_BINARY_GLTF].body);let s=this.options;return new Promise(function(e,i){r.load(n.r6x.resolveURL(t.uri,s.path),e,void 0,function(){i(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})}loadAccessor(e){let t=this,r=this.json,s=this.json.accessors[e];if(void 0===s.bufferView&&void 0===s.sparse){let e=Q[s.type],t=J[s.componentType],r=!0===s.normalized,i=new t(s.count*e);return Promise.resolve(new n.THS(i,e,r))}let i=[];return void 0!==s.bufferView?i.push(this.getDependency("bufferView",s.bufferView)):i.push(null),void 0!==s.sparse&&(i.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(i).then(function(e){let i,o;let a=e[0],l=Q[s.type],u=J[s.componentType],c=u.BYTES_PER_ELEMENT,h=c*l,f=s.byteOffset||0,d=void 0!==s.bufferView?r.bufferViews[s.bufferView].byteStride:void 0,p=!0===s.normalized;if(d&&d!==h){let e=Math.floor(f/d),r="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+e+":"+s.count,h=t.cache.get(r);h||(i=new u(a,e*d,s.count*d/c),h=new n.eB$(i,d/c),t.cache.add(r,h)),o=new n.eHs(h,l,f%d/c,p)}else i=null===a?new u(s.count*l):new u(a,f,s.count*l),o=new n.THS(i,l,p);if(void 0!==s.sparse){let t=Q.SCALAR,r=J[s.sparse.indices.componentType],i=s.sparse.indices.byteOffset||0,c=s.sparse.values.byteOffset||0,h=new r(e[1],i,s.sparse.count*t),f=new u(e[2],c,s.sparse.count*l);null!==a&&(o=new n.THS(o.array.slice(),o.itemSize,o.normalized));for(let e=0,t=h.length;e<t;e++){let t=h[e];if(o.setX(t,f[e*l]),l>=2&&o.setY(t,f[e*l+1]),l>=3&&o.setZ(t,f[e*l+2]),l>=4&&o.setW(t,f[e*l+3]),l>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o})}loadTexture(e){let t=this.json,r=this.options,n=t.textures[e].source,s=t.images[n],i=this.textureLoader;if(s.uri){let e=r.manager.getHandler(s.uri);null!==e&&(i=e)}return this.loadTextureImage(e,n,i)}loadTextureImage(e,t,r){let s=this,i=this.json,o=i.textures[e],a=i.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];let u=this.loadImageSource(t,r).then(function(t){t.flipY=!1,t.name=o.name||a.name||"",""===t.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(t.name=a.uri);let r=(i.samplers||{})[o.sampler]||{};return t.magFilter=$[r.magFilter]||n.k6q,t.minFilter=$[r.minFilter]||n.$_I,t.wrapS=Z[r.wrapS]||n.GJx,t.wrapT=Z[r.wrapT]||n.GJx,s.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,t){let r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let i=r.images[e],o=self.URL||self.webkitURL,a=i.uri||"",l=!1;if(void 0!==i.bufferView)a=this.getDependency("bufferView",i.bufferView).then(function(e){l=!0;let t=new Blob([e],{type:i.mimeType});return a=o.createObjectURL(t)});else if(void 0===i.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let u=Promise.resolve(a).then(function(e){return new Promise(function(r,i){let o=r;!0===t.isImageBitmapLoader&&(o=function(e){let t=new n.gPd(e);t.needsUpdate=!0,r(t)}),t.load(n.r6x.resolveURL(e,s.path),o,void 0,i)})}).then(function(e){var t;return!0===l&&o.revokeObjectURL(a),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),e});return this.sourceCache[e]=u,u}assignTexture(e,t,r,n){let s=this;return this.getDependency("texture",r.index).then(function(i){if(!i)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((i=i.clone()).channel=r.texCoord),s.extensions[_.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[_.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=s.associations.get(i);i=s.extensions[_.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),s.associations.set(i,t)}}return void 0!==n&&(i.colorSpace=n),e[t]=i,i})}assignFinalMaterial(e){let t=e.geometry,r=e.material,s=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new n.BH$,n.imn.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new n.mrM,n.imn.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(s||i||o){let e="ClonedMaterial:"+r.uuid+":";s&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),o&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),i&&(t.vertexColors=!0),o&&(t.flatShading=!0),s&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return n._4j}loadMaterial(e){let t;let r=this,s=this.json,i=this.extensions,o=s.materials[e],a={},l=o.extensions||{},u=[];if(l[_.KHR_MATERIALS_UNLIT]){let e=i[_.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),u.push(e.extendParams(a,o,r))}else{let s=o.pbrMetallicRoughness||{};if(a.color=new n.Q1f(1,1,1),a.opacity=1,Array.isArray(s.baseColorFactor)){let e=s.baseColorFactor;a.color.setRGB(e[0],e[1],e[2],n.Zr2),a.opacity=e[3]}void 0!==s.baseColorTexture&&u.push(r.assignTexture(a,"map",s.baseColorTexture,n.er$)),a.metalness=void 0!==s.metallicFactor?s.metallicFactor:1,a.roughness=void 0!==s.roughnessFactor?s.roughnessFactor:1,void 0!==s.metallicRoughnessTexture&&(u.push(r.assignTexture(a,"metalnessMap",s.metallicRoughnessTexture)),u.push(r.assignTexture(a,"roughnessMap",s.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,a)})))}!0===o.doubleSided&&(a.side=n.$EB);let c=o.alphaMode||en.OPAQUE;if(c===en.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,c===en.MASK&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==n.V9B&&(u.push(r.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new n.I9Y(1,1),void 0!==o.normalTexture.scale)){let e=o.normalTexture.scale;a.normalScale.set(e,e)}if(void 0!==o.occlusionTexture&&t!==n.V9B&&(u.push(r.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==n.V9B){let e=o.emissiveFactor;a.emissive=new n.Q1f().setRGB(e[0],e[1],e[2],n.Zr2)}return void 0!==o.emissiveTexture&&t!==n.V9B&&u.push(r.assignTexture(a,"emissiveMap",o.emissiveTexture,n.er$)),Promise.all(u).then(function(){let n=new t(a);return o.name&&(n.name=o.name),ei(n,o),r.associations.set(n,{materials:e}),o.extensions&&es(i,n,o),n})}createUniqueName(e){let t=n.Nwf.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,r=this.extensions,s=this.primitiveCache,i=[];for(let o=0,a=e.length;o<a;o++){let a=e[o],l=function(e){let t;let r=e.extensions&&e.extensions[_.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+eo(r.attributes):e.indices+":"+eo(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,n=e.targets.length;r<n;r++)t+=":"+eo(e.targets[r]);return t}(a),u=s[l];if(u)i.push(u.promise);else{let e;e=a.extensions&&a.extensions[_.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[_.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return ec(r,e,t)})}(a):ec(new n.LoY,a,t),s[l]={primitive:a,promise:e},i.push(e)}}return Promise.all(i)}loadMesh(e){let t=this,r=this.json,s=this.extensions,i=r.meshes[e],o=i.primitives,a=[];for(let e=0,t=o.length;e<t;e++){var l;let t=void 0===o[e].material?(void 0===(l=this.cache).DefaultMaterial&&(l.DefaultMaterial=new n._4j({color:0xffffff,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.hB5})),l.DefaultMaterial):this.getDependency("material",o[e].material);a.push(t)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(r){let a=r.slice(0,r.length-1),l=r[r.length-1],u=[];for(let r=0,c=l.length;r<c;r++){let c;let h=l[r],f=o[r],d=a[r];if(f.mode===Y.TRIANGLES||f.mode===Y.TRIANGLE_STRIP||f.mode===Y.TRIANGLE_FAN||void 0===f.mode)!0===(c=!0===i.isSkinnedMesh?new n.I46(h,d):new n.eaF(h,d)).isSkinnedMesh&&c.normalizeSkinWeights(),f.mode===Y.TRIANGLE_STRIP?c.geometry=v(c.geometry,n.O49):f.mode===Y.TRIANGLE_FAN&&(c.geometry=v(c.geometry,n.rYR));else if(f.mode===Y.LINES)c=new n.DXC(h,d);else if(f.mode===Y.LINE_STRIP)c=new n.N1A(h,d);else if(f.mode===Y.LINE_LOOP)c=new n.FCc(h,d);else if(f.mode===Y.POINTS)c=new n.ONl(h,d);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);Object.keys(c.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){let r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,n=r.length;t<n;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(c,i),c.name=t.createUniqueName(i.name||"mesh_"+e),ei(c,i),f.extensions&&es(s,c,f),t.assignFinalMaterial(c),u.push(c)}for(let r=0,n=u.length;r<n;r++)t.associations.set(u[r],{meshes:e,primitives:r});if(1===u.length)return i.extensions&&es(s,u[0],i),u[0];let c=new n.YJl;i.extensions&&es(s,c,i),t.associations.set(c,{meshes:e});for(let e=0,t=u.length;e<t;e++)c.add(u[e]);return c})}loadCamera(e){let t;let r=this.json.cameras[e],s=r[r.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?t=new n.ubm(n.cj9.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):"orthographic"===r.type&&(t=new n.qUd(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),ei(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r=[];for(let e=0,n=t.joints.length;e<n;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),s=[],i=[];for(let o=0,a=e.length;o<a;o++){let a=e[o];if(a){s.push(a);let e=new n.kn4;null!==r&&e.fromArray(r.array,16*o),i.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new n.EAD(s,i)})}loadAnimation(e){let t=this.json,r=this,s=t.animations[e],i=s.name?s.name:"animation_"+e,o=[],a=[],l=[],u=[],c=[];for(let e=0,t=s.channels.length;e<t;e++){let t=s.channels[e],r=s.samplers[t.sampler],n=t.target,i=n.node,h=void 0!==s.parameters?s.parameters[r.input]:r.input,f=void 0!==s.parameters?s.parameters[r.output]:r.output;void 0!==n.node&&(o.push(this.getDependency("node",i)),a.push(this.getDependency("accessor",h)),l.push(this.getDependency("accessor",f)),u.push(r),c.push(n))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(c)]).then(function(e){let t=e[0],s=e[1],o=e[2],a=e[3],l=e[4],u=[];for(let e=0,n=t.length;e<n;e++){let n=t[e],i=s[e],c=o[e],h=a[e],f=l[e];if(void 0===n)continue;n.updateMatrix&&n.updateMatrix();let d=r._createAnimationTracks(n,i,c,h,f);if(d)for(let e=0;e<d.length;e++)u.push(d[e])}return new n.tz3(i,void 0,u)})}createNodeMesh(e){let t=this.json,r=this,n=t.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then(function(e){let t=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]}),t})}loadNode(e){let t=this.json.nodes[e],r=this._loadNodeShallow(e),n=[],s=t.children||[];for(let e=0,t=s.length;e<t;e++)n.push(this.getDependency("node",s[e]));let i=void 0===t.skin?Promise.resolve(null):this.getDependency("skin",t.skin);return Promise.all([r,Promise.all(n),i]).then(function(e){let t=e[0],r=e[1],n=e[2];null!==n&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(n,el)});for(let e=0,n=r.length;e<n;e++)t.add(r[e]);return t})}_loadNodeShallow(e){let t=this.json,r=this.extensions,s=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let i=t.nodes[e],o=i.name?s.createUniqueName(i.name):"",a=[],l=s._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return l&&a.push(l),void 0!==i.camera&&a.push(s.getDependency("camera",i.camera).then(function(e){return s._getNodeRef(s.cameraCache,i.camera,e)})),s._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){a.push(e)}),this.nodeCache[e]=Promise.all(a).then(function(t){let a;if((a=!0===i.isBone?new n.$Kf:t.length>1?new n.YJl:1===t.length?t[0]:new n.B69)!==t[0])for(let e=0,r=t.length;e<r;e++)a.add(t[e]);if(i.name&&(a.userData.name=i.name,a.name=o),ei(a,i),i.extensions&&es(r,a,i),void 0!==i.matrix){let e=new n.kn4;e.fromArray(i.matrix),a.applyMatrix4(e)}else void 0!==i.translation&&a.position.fromArray(i.translation),void 0!==i.rotation&&a.quaternion.fromArray(i.rotation),void 0!==i.scale&&a.scale.fromArray(i.scale);return s.associations.has(a)||s.associations.set(a,{}),s.associations.get(a).nodes=e,a}),this.nodeCache[e]}loadScene(e){let t=this.extensions,r=this.json.scenes[e],s=this,i=new n.YJl;r.name&&(i.name=s.createUniqueName(r.name)),ei(i,r),r.extensions&&es(t,i,r);let o=r.nodes||[],a=[];for(let e=0,t=o.length;e<t;e++)a.push(s.getDependency("node",o[e]));return Promise.all(a).then(function(e){for(let t=0,r=e.length;t<r;t++)i.add(e[t]);return s.associations=(e=>{let t=new Map;for(let[e,r]of s.associations)(e instanceof n.imn||e instanceof n.gPd)&&t.set(e,r);return e.traverse(e=>{let r=s.associations.get(e);null!=r&&t.set(e,r)}),t})(i),i})}_createAnimationTracks(e,t,r,s,i){let o;let a=[],l=e.name?e.name:e.uuid,u=[];switch(et[i.path]===et.weights?e.traverse(function(e){e.morphTargetInfluences&&u.push(e.name?e.name:e.uuid)}):u.push(l),et[i.path]){case et.weights:o=n.Hit;break;case et.rotation:o=n.MBL;break;case et.position:case et.scale:o=n.RiT;break;default:o=1===r.itemSize?n.Hit:n.RiT}let c=void 0!==s.interpolation?er[s.interpolation]:n.PJ3,h=this._getArrayFromAccessor(r);for(let e=0,r=u.length;e<r;e++){let r=new o(u[e]+"."+et[i.path],t.array,h,c);"CUBICSPLINE"===s.interpolation&&this._createCubicSplineTrackInterpolant(r),a.push(r)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=ea(t.constructor),r=new Float32Array(t.length);for(let n=0,s=t.length;n<s;n++)r[n]=t[n]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof n.MBL?q:W)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function ec(e,t,r){let s=t.attributes,i=[];for(let t in s){let n=ee[t]||t.toLowerCase();n in e.attributes||i.push(function(t,n){return r.getDependency("accessor",t).then(function(t){e.setAttribute(n,t)})}(s[t],n))}if(void 0!==t.indices&&!e.index){let n=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(n)}return n.ppV.workingColorSpace!==n.Zr2&&"COLOR_0"in s&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${n.ppV.workingColorSpace}" not supported.`),ei(e,t),function(e,t,r){let s=t.attributes,i=new n.NRn;if(void 0===s.POSITION)return;{let e=r.json.accessors[s.POSITION],t=e.min,o=e.max;if(void 0!==t&&void 0!==o){if(i.set(new n.Pq0(t[0],t[1],t[2]),new n.Pq0(o[0],o[1],o[2])),e.normalized){let t=ea(J[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let o=t.targets;if(void 0!==o){let e=new n.Pq0,t=new n.Pq0;for(let n=0,s=o.length;n<s;n++){let s=o[n];if(void 0!==s.POSITION){let n=r.json.accessors[s.POSITION],i=n.min,o=n.max;if(void 0!==i&&void 0!==o){if(t.setX(Math.max(Math.abs(i[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(i[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(i[2]),Math.abs(o[2]))),n.normalized){let e=ea(J[n.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;let a=new n.iyt;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=a}(e,t,r),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,r){let n=!1,s=!1,i=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(n=!0),void 0!==r.NORMAL&&(s=!0),void 0!==r.COLOR_0&&(i=!0),n&&s&&i)break}if(!n&&!s&&!i)return Promise.resolve(e);let o=[],a=[],l=[];for(let u=0,c=t.length;u<c;u++){let c=t[u];if(n){let t=void 0!==c.POSITION?r.getDependency("accessor",c.POSITION):e.attributes.position;o.push(t)}if(s){let t=void 0!==c.NORMAL?r.getDependency("accessor",c.NORMAL):e.attributes.normal;a.push(t)}if(i){let t=void 0!==c.COLOR_0?r.getDependency("accessor",c.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(t){let r=t[0],o=t[1],a=t[2];return n&&(e.morphAttributes.position=r),s&&(e.morphAttributes.normal=o),i&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}class eh{parse(e){let t={},r=e.split(`
`),n=null,s=t,i=[t];for(let e of r)if(e.includes("=")){let t=e.split("="),r=t[0].trim(),n=t[1].trim();if(n.endsWith("{")){let e={};i.push(e),s[r]=e,s=e}else s[r]=n}else if(e.endsWith("{")){let e=s[n]||{};i.push(e),s[n]=e,s=e}else if(e.endsWith("}")){if(i.pop(),0===i.length)continue;s=i[i.length-1]}else if(e.endsWith("(")){let t={};i.push(t),s[n=e.split("(")[0].trim()||n]=t,s=t}else e.endsWith(")")?(i.pop(),s=i[i.length-1]):n=e.trim();return t}}class ef extends n.aHM{constructor(e){super(e)}load(e,t,r,s){let i=this,o=new n.Y9S(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,function(r){try{t(i.parse(r))}catch(t){s?s(t):console.error(t),i.manager.itemError(e)}},r,s)}parse(e){let t=new eh;function r(e){let t=e.slice(0,7),r=new Uint8Array([80,88,82,45,85,83,68,67]);return t.every((e,t)=>e===r[t])}let i=(0,s.u)(new Uint8Array(e)),o=function(e){let i={};for(let o in new n.Y9S().setResponseType("arraybuffer"),e){if(o.endsWith("png")){let t=new Blob([e[o]],{type:{type:"image/png"}});i[o]=URL.createObjectURL(t)}if(o.endsWith("usd")||o.endsWith("usda")){if(r(e[o])){console.warn("THREE.USDZLoader: Crate files (.usdc or binary .usd) are not supported.");continue}let n=(0,s.a)(e[o]);i[o]=t.parse(n)}}return i}(i),a=function(e){if(e.length<1)return;let t=Object.keys(e)[0],n=!1;if(t.endsWith("usda"))return e[t];if(t.endsWith("usdc"))n=!0;else if(t.endsWith("usd")){if(!r(e[t]))return e[t];n=!0}n&&console.warn("THREE.USDZLoader: Crate files (.usdc or binary .usd) are not supported.")}(i);if(void 0===a)return console.warn("THREE.USDZLoader: No usda file found."),new n.YJl;let l=(0,s.a)(a),u=t.parse(l);function c(e,t){if(e){if(void 0!==t){let r=`def Mesh "${t}"`;if(r in e)return e[r]}for(let t in e){let r=e[t];if(t.startsWith("def Mesh"))return"point3f[] points"in e&&(r["point3f[] points"]=e["point3f[] points"]),"texCoord2f[] primvars:st"in e&&(r["texCoord2f[] primvars:st"]=e["texCoord2f[] primvars:st"]),"int[] primvars:st:indices"in e&&(r["int[] primvars:st:indices"]=e["int[] primvars:st:indices"]),r;if("object"==typeof r){let e=c(r);if(e)return e}}}}function h(e,t=""){for(let r in e){let n=e[r];if(r.startsWith("def Material"+t))return n;if("object"==typeof n){let e=h(n,t);if(e)return e}}}function f(e,t){t["float inputs:rotation"]&&(e.rotation=parseFloat(t["float inputs:rotation"])),t["float2 inputs:scale"]&&(e.repeat=new n.I9Y().fromArray(JSON.parse("["+t["float2 inputs:scale"].replace(/[()]*/g,"")+"]"))),t["float2 inputs:translation"]&&(e.offset=new n.I9Y().fromArray(JSON.parse("["+t["float2 inputs:translation"].replace(/[()]*/g,"")+"]")))}function d(e,t){for(let r in e){let n=e[r];if(r.startsWith(`def Shader "${t}"`))return n;if("object"==typeof n){let e=d(n,t);if(e)return e}}}function p(e){if("asset inputs:file"in e){let t=e["asset inputs:file"].replace(/@*/g,""),r=new n.Tap().load(o[t]),s={'"clamp"':n.ghU,'"mirror"':n.kTW,'"repeat"':n.GJx};return"token inputs:wrapS"in e&&(r.wrapS=s[e["token inputs:wrapS"]]),"token inputs:wrapT"in e&&(r.wrapT=s[e["token inputs:wrapT"]]),r}return null}let m=new n.YJl;return function e(t,r){for(let s in t)if(s.startsWith("def Scope"))e(t[s],r);else if(s.startsWith("def Xform")){let i=function(e){let t=function(e){if(!e)return;let t=new n.LoY;if("int[] faceVertexIndices"in e){let r=JSON.parse(e["int[] faceVertexIndices"]);t.setIndex(r)}if("point3f[] points"in e){let r=JSON.parse(e["point3f[] points"].replace(/[()]*/g,"")),s=new n.THS(new Float32Array(r),3);t.setAttribute("position",s)}if("normal3f[] normals"in e){let r=JSON.parse(e["normal3f[] normals"].replace(/[()]*/g,"")),s=new n.THS(new Float32Array(r),3);t.setAttribute("normal",s)}else t.computeVertexNormals();if("float2[] primvars:st"in e&&(e["texCoord2f[] primvars:st"]=e["float2[] primvars:st"]),"texCoord2f[] primvars:st"in e){let r=JSON.parse(e["texCoord2f[] primvars:st"].replace(/[()]*/g,"")),s=new n.THS(new Float32Array(r),2);if("int[] primvars:st:indices"in e){t=t.toNonIndexed();let r=JSON.parse(e["int[] primvars:st:indices"]);t.setAttribute("uv",function(e,t){let r=e.array,s=e.itemSize,i=new r.constructor(t.length*s),o=0,a=0;for(let e=0,n=t.length;e<n;e++){o=t[e]*s;for(let e=0;e<s;e++)i[a++]=r[o++]}return new n.THS(i,s)}(s,r))}else t.setAttribute("uv",s)}return t}(function(e){if(e){if("prepend references"in e){let t=e["prepend references"].split("@"),r=t[1].replace(/^.\//,""),n=t[2].replace(/^<\//,"").replace(/>$/,"");return c(o[r],n)}return c(e)}}(e)),r=function(e){let t=new n.uSd;if(void 0!==e){if('def Shader "PreviewSurface"'in e){let r=e['def Shader "PreviewSurface"'];if("color3f inputs:diffuseColor.connect"in r){let s=r["color3f inputs:diffuseColor.connect"],i=d(u,/(\w+).output/.exec(s)[1]);t.map=p(i),t.map.colorSpace=n.er$,'def Shader "Transform2d_diffuse"'in e&&f(t.map,e['def Shader "Transform2d_diffuse"'])}else if("color3f inputs:diffuseColor"in r){let e=r["color3f inputs:diffuseColor"].replace(/[()]*/g,"");t.color.fromArray(JSON.parse("["+e+"]"))}if("color3f inputs:emissiveColor.connect"in r){let s=r["color3f inputs:emissiveColor.connect"],i=d(u,/(\w+).output/.exec(s)[1]);t.emissiveMap=p(i),t.emissiveMap.colorSpace=n.er$,t.emissive.set(0xffffff),'def Shader "Transform2d_emissive"'in e&&f(t.emissiveMap,e['def Shader "Transform2d_emissive"'])}else if("color3f inputs:emissiveColor"in r){let e=r["color3f inputs:emissiveColor"].replace(/[()]*/g,"");t.emissive.fromArray(JSON.parse("["+e+"]"))}if("normal3f inputs:normal.connect"in r){let s=r["normal3f inputs:normal.connect"],i=d(u,/(\w+).output/.exec(s)[1]);t.normalMap=p(i),t.normalMap.colorSpace=n.jf0,'def Shader "Transform2d_normal"'in e&&f(t.normalMap,e['def Shader "Transform2d_normal"'])}if("float inputs:roughness.connect"in r){let s=r["float inputs:roughness.connect"],i=d(u,/(\w+).output/.exec(s)[1]);t.roughness=1,t.roughnessMap=p(i),t.roughnessMap.colorSpace=n.jf0,'def Shader "Transform2d_roughness"'in e&&f(t.roughnessMap,e['def Shader "Transform2d_roughness"'])}else"float inputs:roughness"in r&&(t.roughness=parseFloat(r["float inputs:roughness"]));if("float inputs:metallic.connect"in r){let s=r["float inputs:metallic.connect"],i=d(u,/(\w+).output/.exec(s)[1]);t.metalness=1,t.metalnessMap=p(i),t.metalnessMap.colorSpace=n.jf0,'def Shader "Transform2d_metallic"'in e&&f(t.metalnessMap,e['def Shader "Transform2d_metallic"'])}else"float inputs:metallic"in r&&(t.metalness=parseFloat(r["float inputs:metallic"]));if("float inputs:clearcoat.connect"in r){let s=r["float inputs:clearcoat.connect"],i=d(u,/(\w+).output/.exec(s)[1]);t.clearcoat=1,t.clearcoatMap=p(i),t.clearcoatMap.colorSpace=n.jf0,'def Shader "Transform2d_clearcoat"'in e&&f(t.clearcoatMap,e['def Shader "Transform2d_clearcoat"'])}else"float inputs:clearcoat"in r&&(t.clearcoat=parseFloat(r["float inputs:clearcoat"]));if("float inputs:clearcoatRoughness.connect"in r){let s=r["float inputs:clearcoatRoughness.connect"],i=d(u,/(\w+).output/.exec(s)[1]);t.clearcoatRoughness=1,t.clearcoatRoughnessMap=p(i),t.clearcoatRoughnessMap.colorSpace=n.jf0,'def Shader "Transform2d_clearcoatRoughness"'in e&&f(t.clearcoatRoughnessMap,e['def Shader "Transform2d_clearcoatRoughness"'])}else"float inputs:clearcoatRoughness"in r&&(t.clearcoatRoughness=parseFloat(r["float inputs:clearcoatRoughness"]));if("float inputs:ior"in r&&(t.ior=parseFloat(r["float inputs:ior"])),"float inputs:occlusion.connect"in r){let s=r["float inputs:occlusion.connect"],i=d(u,/(\w+).output/.exec(s)[1]);t.aoMap=p(i),t.aoMap.colorSpace=n.jf0,'def Shader "Transform2d_occlusion"'in e&&f(t.aoMap,e['def Shader "Transform2d_occlusion"'])}}if('def Shader "diffuseColor_texture"'in e){let r=e['def Shader "diffuseColor_texture"'];t.map=p(r),t.map.colorSpace=n.er$}if('def Shader "normal_texture"'in e){let r=e['def Shader "normal_texture"'];t.normalMap=p(r),t.normalMap.colorSpace=n.jf0}}return t}(function(e){if(e){if("rel material:binding"in e){let t=e["rel material:binding"].replace(/^<\//,"").replace(/>$/,"").split("/");return h(u,` "${t[1]}"`)}return h(e)}}(e)),s=t?new n.eaF(t,r):new n.B69;if("matrix4d xformOp:transform"in e){let t=JSON.parse("["+e["matrix4d xformOp:transform"].replace(/[()]*/g,"")+"]");s.matrix.fromArray(t),s.matrix.decompose(s.position,s.quaternion,s.scale)}return s}(t[s]);/def Xform "(\w+)"/.test(s)&&(i.name=/def Xform "(\w+)"/.exec(s)[1]),r.add(i),e(t[s],i)}}(u,m),m}}let ed=new WeakMap;class ep extends n.aHM{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,s){let i=new n.Y9S(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,e=>{this.parse(e,t,s)},r,s)}parse(e,t,r=()=>{}){this.decodeDracoFile(e,t,null,null,n.er$).catch(r)}decodeDracoFile(e,t,r,s,i=n.Zr2,o=()=>{}){let a={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!r,vertexColorSpace:i};return this.decodeGeometry(e,a).then(t).catch(o)}decodeGeometry(e,t){let r;let n=JSON.stringify(t);if(ed.has(e)){let t=ed.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s=this.workerNextTaskID++,i=e.byteLength,o=this._getWorker(s,i).then(n=>(r=n,new Promise((n,i)=>{r._callbacks[s]={resolve:n,reject:i},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return o.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),ed.set(e,{key:n,promise:o}),o}_createGeometry(e){let t=new n.LoY;e.index&&t.setIndex(new n.THS(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let s=e.attributes[r],i=s.name,o=s.array,a=s.itemSize,l=new n.THS(o,a);"color"===i&&(this._assignVertexColorSpace(l,s.vertexColorSpace),l.normalized=!(o instanceof Float32Array)),t.setAttribute(i,l)}return t}_assignVertexColorSpace(e,t){if(t!==n.er$)return;let r=new n.Q1f;for(let t=0,n=e.count;t<n;t++)r.fromBufferAttribute(e,t).convertSRGBToLinear(),e.setXYZ(t,r.r,r.g,r.b)}_loadLibrary(e,t){let r=new n.Y9S(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((t,n)=>{r.load(e,t,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{let r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let n=em.toString(),s=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function em(){let e,t;onmessage=function(r){let n=r.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":let s=n.buffer,i=n.taskConfig;t.then(e=>{let t=e.draco,r=new t.Decoder;try{let e=function(e,t,r,n){let s,i;let o=n.attributeIDs,a=n.attributeTypes,l=t.GetEncodedGeometryType(r);if(l===e.TRIANGULAR_MESH)s=new e.Mesh,i=t.DecodeArrayToMesh(r,r.byteLength,s);else if(l===e.POINT_CLOUD)s=new e.PointCloud,i=t.DecodeArrayToPointCloud(r,r.byteLength,s);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!i.ok()||0===s.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+i.error_msg());let u={index:null,attributes:[]};for(let r in o){let i,l;let c=self[a[r]];if(n.useUniqueIDs)l=o[r],i=t.GetAttributeByUniqueId(s,l);else{if(-1===(l=t.GetAttributeId(s,e[o[r]])))continue;i=t.GetAttribute(s,l)}let h=function(e,t,r,n,s,i){let o=i.num_components(),a=r.num_points()*o,l=a*s.BYTES_PER_ELEMENT,u=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,s),c=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,i,u,l,c);let h=new s(e.HEAPF32.buffer,c,a).slice();return e._free(c),{name:n,array:h,itemSize:o}}(e,t,s,r,c,i);"color"===r&&(h.vertexColorSpace=n.vertexColorSpace),u.attributes.push(h)}return l===e.TRIANGULAR_MESH&&(u.index=function(e,t,r){let n=3*r.num_faces(),s=4*n,i=e._malloc(s);t.GetTrianglesUInt32Array(r,s,i);let o=new Uint32Array(e.HEAPF32.buffer,i,n).slice();return e._free(i),{array:o,itemSize:1}}(e,t,s)),e.destroy(s),u}(t,r,new Int8Array(s),i),o=e.attributes.map(e=>e.array.buffer);e.index&&o.push(e.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:e},o)}catch(e){console.error(e),self.postMessage({type:"error",id:n.id,error:e.message})}finally{t.destroy(r)}})}}}function eg(){let e,t;onmessage=function(r){let n=r.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":let s=n.buffer,i=n.taskConfig;t.then(e=>{let t=e.draco,r=new t.Decoder;try{let e=function(e,t,r,n){let s,i;let o=n.attributeIDs,a=n.attributeTypes,l=t.GetEncodedGeometryType(r);if(l===e.TRIANGULAR_MESH)s=new e.Mesh,i=t.DecodeArrayToMesh(r,r.byteLength,s);else if(l===e.POINT_CLOUD)s=new e.PointCloud,i=t.DecodeArrayToPointCloud(r,r.byteLength,s);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!i.ok()||0===s.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+i.error_msg());let u={index:null,attributes:[]};for(let r in o){let i,l;let c=self[a[r]];if(n.useUniqueIDs)l=o[r],i=t.GetAttributeByUniqueId(s,l);else{if(-1===(l=t.GetAttributeId(s,e[o[r]])))continue;i=t.GetAttribute(s,l)}let h=function(e,t,r,n,s,i){let o=i.num_components(),a=r.num_points()*o,l=a*s.BYTES_PER_ELEMENT,u=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,s),c=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,i,u,l,c);let h=new s(e.HEAPF32.buffer,c,a).slice();return e._free(c),{name:n,array:h,itemSize:o}}(e,t,s,r,c,i);"color"===r&&(h.vertexColorSpace=n.vertexColorSpace),u.attributes.push(h)}return l===e.TRIANGULAR_MESH&&(u.index=function(e,t,r){let n=3*r.num_faces(),s=4*n,i=e._malloc(s);t.GetTrianglesUInt32Array(r,s,i);let o=new Uint32Array(e.HEAPF32.buffer,i,n).slice();return e._free(i),{array:o,itemSize:1}}(e,t,s)),e.destroy(s),u}(t,r,new Int8Array(s),i),o=e.attributes.map(e=>e.array.buffer);e.index&&o.push(e.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:e},o)}catch(e){console.error(e),self.postMessage({type:"error",id:n.id,error:e.message})}finally{t.destroy(r)}})}}}let eA={LOAD_DRACO_JS_DECODER:async()=>(await r.e(2595).then(r.bind(r,2595))).default,LOAD_DRACO_WASM_WRAPPER:async()=>(await r.e(60414).then(r.bind(r,414))).default,LOAD_DRACO_WASM_DECODER:async()=>{let e=(await r.e(35021).then(r.bind(r,5021))).default;return await (await fetch(e)).arrayBuffer()}};class eT extends ep{constructor(){super(...arguments),T(this,"decoderPending",null),T(this,"decoderConfig",{type:"js",wasmBinary:null}),T(this,"workerSourceURL","")}async _initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(eA.LOAD_DRACO_JS_DECODER()):(t.push(eA.LOAD_DRACO_WASM_WRAPPER()),t.push(eA.LOAD_DRACO_WASM_DECODER())),this.decoderPending=Promise.all(t).then(t=>{let r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let n=eg.toString(),s=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}}class ev{constructor(){T(this,"_gltfLoader"),T(this,"_usdzLoader");let e=new eT;e.setDecoderConfig({type:"wasm"}),this._gltfLoader=new x,this._gltfLoader.setDRACOLoader(e),this._usdzLoader=new ef}async load(e){let t=(0,o.g)(e);if(0===t.length)throw new a.F("No file extension found in URI","");if(!(0,o.i)(t))throw new a.F(`Unsupported file type: ${t}. Supported types: ${i.S.join(", ")}`,t);let r=m.read(e);if(r)return r.arrayBuffer?this._parse(r.arrayBuffer,t):r.promise.then(e=>this._parse(e,t));let n=await m.create(e).load();return this._parse(n,t)}async _parse(e,t){try{switch(t){case"glb":case"gltf":return(await this._gltfLoader.parseAsync(e,"")).scene;case"usdz":return await this._usdzLoader.parse(e)}}catch(e){throw e instanceof Error?new a.P(`Failed to parse ${t} file: ${e.message}`,e):new a.P(`Failed to parse ${t} file`)}}}},4808:(e,t,r)=>{r.d(t,{a:()=>es,s:()=>en,u:()=>eh,z:()=>ec});/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var n=Uint8Array,s=Uint16Array,i=Int32Array,o=new n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),l=new n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u=function(e,t){for(var r=new s(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var o=new i(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)o[a]=a-r[n]<<5|n;return{b:r,r:o}},c=u(o,2),h=c.b,f=c.r;h[28]=258,f[258]=28;for(var d=u(a,0),p=d.b,m=d.r,g=new s(32768),A=0;A<32768;++A){var T=(43690&A)>>1|(21845&A)<<1;T=(61680&(T=(52428&T)>>2|(13107&T)<<2))>>4|(3855&T)<<4,g[A]=((65280&T)>>8|(255&T)<<8)>>1}for(var v=function(e,t,r){for(var n,i=e.length,o=0,a=new s(t);o<i;++o)e[o]&&++a[e[o]-1];var l=new s(t);for(o=1;o<t;++o)l[o]=l[o-1]+a[o-1]<<1;if(r){n=new s(1<<t);var u=15-t;for(o=0;o<i;++o)if(e[o])for(var c=o<<4|e[o],h=t-e[o],f=l[e[o]-1]++<<h,d=f|(1<<h)-1;f<=d;++f)n[g[f]>>u]=c}else for(n=new s(i),o=0;o<i;++o)e[o]&&(n[o]=g[l[e[o]-1]++]>>15-e[o]);return n},x=new n(288),A=0;A<144;++A)x[A]=8;for(var A=144;A<256;++A)x[A]=9;for(var A=256;A<280;++A)x[A]=7;for(var A=280;A<288;++A)x[A]=8;for(var w=new n(32),A=0;A<32;++A)w[A]=5;var _=v(x,9,0),y=v(x,9,1),R=v(w,5,0),b=v(w,5,1),S=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},E=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},L=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},M=function(e){return(e+7)/8|0},I=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new n(e.subarray(t,r))},C=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],O=function(e,t,r){var n=Error(t||C[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,O),!r)throw n;return n},P=function(e,t,r,s){var i=e.length,u=s?s.length:0;if(!i||t.f&&!t.l)return r||new n(0);var c=!r,f=c||2!=t.i,d=t.i;c&&(r=new n(3*i));var m=function(e){var t=r.length;if(e>t){var s=new n(Math.max(2*t,e));s.set(r),r=s}},g=t.f||0,A=t.p||0,T=t.b||0,x=t.l,w=t.d,_=t.m,R=t.n,C=8*i;do{if(!x){g=E(e,A,1);var P=E(e,A+1,3);if(A+=3,P){if(1==P)x=y,w=b,_=9,R=5;else if(2==P){var N=E(e,A,31)+257,k=E(e,A+10,15)+4,D=N+E(e,A+5,31)+1;A+=14;for(var H=new n(D),U=new n(19),F=0;F<k;++F)U[l[F]]=E(e,A+3*F,7);A+=3*k;for(var B=S(U),G=(1<<B)-1,j=v(U,B,1),F=0;F<D;){var K=j[E(e,A,G)];A+=15&K;var V=K>>4;if(V<16)H[F++]=V;else{var X=0,W=0;for(16==V?(W=3+E(e,A,3),A+=2,X=H[F-1]):17==V?(W=3+E(e,A,7),A+=3):18==V&&(W=11+E(e,A,127),A+=7);W--;)H[F++]=X}}var z=H.subarray(0,N),q=H.subarray(N);_=S(z),R=S(q),x=v(z,_,1),w=v(q,R,1)}else O(1)}else{var V=M(A)+4,Y=e[V-4]|e[V-3]<<8,J=V+Y;if(J>i){d&&O(0);break}f&&m(T+Y),r.set(e.subarray(V,J),T),t.b=T+=Y,t.p=A=8*J,t.f=g;continue}if(A>C){d&&O(0);break}}f&&m(T+131072);for(var $=(1<<_)-1,Z=(1<<R)-1,Q=A;;Q=A){var X=x[L(e,A)&$],ee=X>>4;if((A+=15&X)>C){d&&O(0);break}if(X||O(2),ee<256)r[T++]=ee;else if(256==ee){Q=A,x=null;break}else{var et=ee-254;if(ee>264){var F=ee-257,er=o[F];et=E(e,A,(1<<er)-1)+h[F],A+=er}var en=w[L(e,A)&Z],es=en>>4;en||O(3),A+=15&en;var q=p[es];if(es>3){var er=a[es];q+=L(e,A)&(1<<er)-1,A+=er}if(A>C){d&&O(0);break}f&&m(T+131072);var ei=T+et;if(T<q){var eo=u-q,ea=Math.min(q,ei);for(eo+T<0&&O(3);T<ea;++T)r[T]=s[eo+T]}for(;T<ei;++T)r[T]=r[T-q]}}t.l=x,t.p=Q,t.b=T,t.f=g,x&&(g=1,t.m=_,t.d=w,t.n=R)}while(!g)return T!=r.length&&c?I(r,0,T):r.subarray(0,T)},N=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},k=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},D=function(e,t){for(var r=[],i=0;i<e.length;++i)e[i]&&r.push({s:i,f:e[i]});var o=r.length,a=r.slice();if(!o)return{t:K,l:0};if(1==o){var l=new n(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var u=r[0],c=r[1],h=0,f=1,d=2;for(r[0]={s:-1,f:u.f+c.f,l:u,r:c};f!=o-1;)u=r[r[h].f<r[d].f?h++:d++],c=r[h!=f&&r[h].f<r[d].f?h++:d++],r[f++]={s:-1,f:u.f+c.f,l:u,r:c};for(var p=a[0].s,i=1;i<o;++i)a[i].s>p&&(p=a[i].s);var m=new s(p+1),g=H(r[f-1],m,0);if(g>t){var i=0,A=0,T=g-t,v=1<<T;for(a.sort(function(e,t){return m[t.s]-m[e.s]||e.f-t.f});i<o;++i){var x=a[i].s;if(m[x]>t)A+=v-(1<<g-m[x]),m[x]=t;else break}for(A>>=T;A>0;){var w=a[i].s;m[w]<t?A-=1<<t-m[w]++-1:++i}for(;i>=0&&A;--i){var _=a[i].s;m[_]==t&&(--m[_],++A)}g=t}return{t:new n(m),l:g}},H=function(e,t,r){return -1==e.s?Math.max(H(e.l,t,r+1),H(e.r,t,r+1)):t[e.s]=r},U=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new s(++t),n=0,i=e[0],o=1,a=function(e){r[n++]=e},l=1;l<=t;++l)if(e[l]==i&&l!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(i),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(i);o=1,i=e[l]}return{c:r.subarray(0,n),n:t}},F=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},B=function(e,t,r){var n=r.length,s=M(t+2);e[s]=255&n,e[s+1]=n>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var i=0;i<n;++i)e[s+i+4]=r[i];return(s+4+n)*8},G=function(e,t,r,n,i,u,c,h,f,d,p){N(t,p++,r),++i[256];for(var m,g,A,T,y=D(i,15),b=y.t,S=y.l,E=D(u,15),L=E.t,M=E.l,I=U(b),C=I.c,O=I.n,P=U(L),H=P.c,G=P.n,j=new s(19),K=0;K<C.length;++K)++j[31&C[K]];for(var K=0;K<H.length;++K)++j[31&H[K]];for(var V=D(j,7),X=V.t,W=V.l,z=19;z>4&&!X[l[z-1]];--z);var q=d+5<<3,Y=F(i,x)+F(u,w)+c,J=F(i,b)+F(u,L)+c+14+3*z+F(j,X)+2*j[16]+3*j[17]+7*j[18];if(f>=0&&q<=Y&&q<=J)return B(t,p,e.subarray(f,f+d));if(N(t,p,1+(J<Y)),p+=2,J<Y){m=v(b,S,0),g=b,A=v(L,M,0),T=L;var $=v(X,W,0);N(t,p,O-257),N(t,p+5,G-1),N(t,p+10,z-4),p+=14;for(var K=0;K<z;++K)N(t,p+3*K,X[l[K]]);p+=3*z;for(var Z=[C,H],Q=0;Q<2;++Q)for(var ee=Z[Q],K=0;K<ee.length;++K){var et=31&ee[K];N(t,p,$[et]),p+=X[et],et>15&&(N(t,p,ee[K]>>5&127),p+=ee[K]>>12)}}else m=_,g=x,A=R,T=w;for(var K=0;K<h;++K){var er=n[K];if(er>255){var et=er>>18&31;k(t,p,m[et+257]),p+=g[et+257],et>7&&(N(t,p,er>>23&31),p+=o[et]);var en=31&er;k(t,p,A[en]),p+=T[en],en>3&&(k(t,p,er>>5&8191),p+=a[en])}else k(t,p,m[er]),p+=g[er]}return k(t,p,m[256]),p+g[256]},j=new i([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),K=new n(0),V=function(e,t,r,l,u,c){var h=c.z||e.length,d=new n(l+h+5*(1+Math.ceil(h/7e3))+u),p=d.subarray(l,d.length-u),g=c.l,A=7&(c.r||0);if(t){A&&(p[0]=c.r>>3);for(var T=j[t-1],v=T>>13,x=8191&T,w=(1<<r)-1,_=c.p||new s(32768),y=c.h||new s(w+1),R=Math.ceil(r/3),b=2*R,S=function(t){return(e[t]^e[t+1]<<R^e[t+2]<<b)&w},E=new i(25e3),L=new s(288),C=new s(32),O=0,P=0,N=c.i||0,k=0,D=c.w||0,H=0;N+2<h;++N){var U=S(N),F=32767&N,K=y[U];if(_[F]=K,y[U]=F,D<=N){var V=h-N;if((O>7e3||k>24576)&&(V>423||!g)){A=G(e,p,0,E,L,C,P,k,H,N-H,A),k=O=P=0,H=N;for(var X=0;X<286;++X)L[X]=0;for(var X=0;X<30;++X)C[X]=0}var W=2,z=0,q=x,Y=F-K&32767;if(V>2&&U==S(N-Y))for(var J=Math.min(v,V)-1,$=Math.min(32767,N),Z=Math.min(258,V);Y<=$&&--q&&F!=K;){if(e[N+W]==e[N+W-Y]){for(var Q=0;Q<Z&&e[N+Q]==e[N+Q-Y];++Q);if(Q>W){if(W=Q,z=Y,Q>J)break;for(var ee=Math.min(Y,Q-2),et=0,X=0;X<ee;++X){var er=N-Y+X&32767,en=_[er],es=er-en&32767;es>et&&(et=es,K=er)}}}K=_[F=K],Y+=F-K&32767}if(z){E[k++]=0x10000000|f[W]<<18|m[z];var ei=31&f[W],eo=31&m[z];P+=o[ei]+a[eo],++L[257+ei],++C[eo],D=N+W,++O}else E[k++]=e[N],++L[e[N]]}}for(N=Math.max(N,D);N<h;++N)E[k++]=e[N],++L[e[N]];A=G(e,p,g,E,L,C,P,k,H,N-H,A),g||(c.r=7&A|p[A/8|0]<<3,A-=7,c.h=y,c.p=_,c.i=N,c.w=D)}else{for(var N=c.w||0;N<h+g;N+=65535){var ea=N+65535;ea>=h&&(p[A/8|0]=g,ea=h),A=B(p,A+1,e.subarray(N,ea))}c.i=h}return I(d,0,l+M(A)+u)},X=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var r=t,n=9;--n;)r=(1&r&&-0x12477ce0)^r>>>1;e[t]=r}return e}(),W=function(){var e=-1;return{p:function(t){for(var r=e,n=0;n<t.length;++n)r=X[255&r^t[n]]^r>>>8;e=r},d:function(){return~e}}},z=function(e,t,r,s,i){if(!i&&(i={l:1},t.dictionary)){var o=t.dictionary.subarray(-32768),a=new n(o.length+e.length);a.set(o),a.set(e,o.length),e=a,i.w=o.length}return V(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,s,i)},q=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},Y=function(e,t){return e[t]|e[t+1]<<8},J=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},$=function(e,t){return J(e,t)+0x100000000*J(e,t+4)},Z=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},Q=function(e,t,r,s){for(var i in e){var o=e[i],a=t+i,l=s;Array.isArray(o)&&(l=q(s,o[1]),o=o[0]),o instanceof n?r[a]=[o,l]:(r[a+="/"]=[new n(0),l],Q(o,a,r,s))}},ee="u">typeof TextEncoder&&new TextEncoder,et="u">typeof TextDecoder&&new TextDecoder;try{et.decode(K,{stream:!0})}catch{}var er=function(e){for(var t="",r=0;;){var n=e[r++],s=(n>127)+(n>223)+(n>239);if(r+s>e.length)return{s:t,r:I(e,r-1)};s?3==s?t+=String.fromCharCode(55296|(n=((15&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536)>>10,56320|1023&n):1&s?t+=String.fromCharCode((31&n)<<6|63&e[r++]):t+=String.fromCharCode((15&n)<<12|(63&e[r++])<<6|63&e[r++]):t+=String.fromCharCode(n)}};function en(e,t){var r;if(ee)return ee.encode(e);for(var s=e.length,i=new n(e.length+(e.length>>1)),o=0,a=function(e){i[o++]=e},r=0;r<s;++r){if(o+5>i.length){var l=new n(o+8+(s-r<<1));l.set(i),i=l}var u=e.charCodeAt(r);u<128||t?a(u):(u<2048?a(192|u>>6):(u>55295&&u<57344?(a(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++r))>>18),a(128|u>>12&63)):a(224|u>>12),a(128|u>>6&63)),a(128|63&u))}return I(i,0,o)}function es(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}if(et)return et.decode(e);var s=er(e),i=s.s,r=s.r;return r.length&&O(8),i}var ei=function(e,t,r){var n=Y(e,t+28),s=es(e.subarray(t+46,t+46+n),!(2048&Y(e,t+8))),i=t+46+n,o=J(e,t+20),a=r&&0xffffffff==o?eo(e,i):[o,J(e,t+24),J(e,t+42)],l=a[0],u=a[1],c=a[2];return[Y(e,t+10),l,u,s,i+Y(e,t+30)+Y(e,t+32),c]},eo=function(e,t){for(;1!=Y(e,t);t+=4+Y(e,t+2));return[$(e,t+12),$(e,t+4),$(e,t+20)]},ea=function(e){var t=0;if(e)for(var r in e){var n=e[r].length;n>65535&&O(9),t+=n+4}return t},el=function(e,t,r,n,s,i,o,a){var l=n.length,u=r.extra,c=a&&a.length,h=ea(u);Z(e,t,null!=o?0x2014b50:0x4034b50),t+=4,null!=o&&(e[t++]=20,e[t++]=r.os),e[t]=20,t+=2,e[t++]=r.flag<<1|(i<0&&8),e[t++]=s&&8,e[t++]=255&r.compression,e[t++]=r.compression>>8;var f=new Date(null==r.mtime?Date.now():r.mtime),d=f.getFullYear()-1980;if((d<0||d>119)&&O(10),Z(e,t,d<<25|f.getMonth()+1<<21|f.getDate()<<16|f.getHours()<<11|f.getMinutes()<<5|f.getSeconds()>>1),t+=4,-1!=i&&(Z(e,t,r.crc),Z(e,t+4,i<0?-i-2:i),Z(e,t+8,r.size)),Z(e,t+12,l),Z(e,t+14,h),t+=16,null!=o&&(Z(e,t,c),Z(e,t+6,r.attrs),Z(e,t+10,o),t+=14),e.set(n,t),t+=l,h)for(var p in u){var m=u[p],g=m.length;Z(e,t,+p),Z(e,t+2,g),e.set(m,t+4),t+=4+g}return c&&(e.set(a,t),t+=c),t},eu=function(e,t,r,n,s){Z(e,t,0x6054b50),Z(e,t+8,r),Z(e,t+10,r),Z(e,t+12,n),Z(e,t+16,s)};function ec(e,t){t||(t={});var r={},s=[];Q(e,"",r,t);var i=0,o=0;for(var a in r){var l=r[a],u=l[0],c=l[1],h=8*(0!=c.level),f=en(a),d=f.length,p=c.comment,m=p&&en(p),g=m&&m.length,A=ea(c.extra);d>65535&&O(11);var T=h?z(u,c||{},0,0):u,v=T.length,x=W();x.p(u),s.push(q(c,{size:u.length,crc:x.d(),c:T,f:f,m:m,u:d!=a.length||m&&p.length!=g,o:i,compression:h})),i+=30+d+A+v,o+=76+2*(d+A)+(g||0)+v}for(var w=new n(o+22),_=i,y=o-i,R=0;R<s.length;++R){var f=s[R];el(w,f.o,f,f.f,f.u,f.c.length);var b=30+f.f.length+ea(f.extra);w.set(f.c,f.o+b),el(w,i,f,f.f,f.u,f.c.length,f.o,f.m),i+=16+b+(f.m?f.m.length:0)}return eu(w,i,s.length,y,_),w}function eh(e,t){for(var r={},s=e.length-22;0x6054b50!=J(e,s);--s)(!s||e.length-s>65558)&&O(13);var i=Y(e,s+8);if(!i)return{};var o=J(e,s+16),a=0xffffffff==o||65535==i;if(a){var l=J(e,s-12);(a=0x6064b50==J(e,l))&&(i=J(e,l+32),o=J(e,l+48))}for(var u=0;u<i;++u){var c,h=ei(e,o,a),f=h[0],d=h[1],p=h[2],m=h[3],g=h[4],A=h[5],T=A+30+Y(e,A+26)+Y(e,A+28);o=g,f?8==f?r[m]=P(e.subarray(T,T+d),{i:2},(c={out:new n(p)}).out,c&&c.dictionary):O(14,"unknown compression type "+f):r[m]=I(e,T,T+d)}return r}},811:(e,t,r)=>{function n(e){var t;let r=e.split("/").pop()||"";return!r.includes(".")||r.endsWith(".")?"":(null==(t=r.split(".").pop())?void 0:t.toLowerCase().split("?")[0])||""}function s(e){return e.toLowerCase()in{glb:!0,gltf:!0,usdz:!0}}r.d(t,{g:()=>n,i:()=>s})},2108:(e,t,r)=>{r.d(t,{F:()=>n,N:()=>s});class n extends Error{constructor(e){super(`Failed to create array buffer from fetched file! (Uri: ${e})`),this.uri=e,this.name="FileContentError"}}class s extends Error{constructor(e,t){super(`Failed to fetch file from ${e}`),this.url=e,this.cause=t,this.name="NetworkError"}}},5349:(e,t,r)=>{r.d(t,{F:()=>n,P:()=>s});class n extends Error{constructor(e,t){super(e),this.requestedFileType=t,this.name="FileTypeError"}}class s extends Error{constructor(e,t){super(`Failed to parse array buffer from ${e}`),this.uri=e,this.cause=t,this.name="ParseError"}}}}]);